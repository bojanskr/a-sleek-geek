---
layout: post
title: 'Sql Server: Delete duplicate rows with CTE'
date: 2015-03-13 10:11:40.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- BESTPRACTICES
- SQL
- SQLSERVER
tags: []
meta:
  _oembed_ad49d852ec902fe1c3e52a8ff30bb26d: "{{unknown}}"
  _wpas_skip_linkedin: '1'
  _wpas_skip_twitter: '1'
  _wpas_skip_google_plus: '1'
  _wpas_skip_facebook: '1'
  _wpas_skip_tumblr: '1'
  _wpas_skip_path: '1'
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _oembed_406b629c555cda833a311e4b19f942e9: "{{unknown}}"
  _oembed_82b588fc775aab607e087bf9132d0e00: "{{unknown}}"
  _publicize_job_id: '48192229383'
  _oembed_de7545bcc097dc132bf5708340e3aafb: "{{unknown}}"
  _import_session_id: 5f57b340a397b
  _import_original_post_id: '95'
  original_post_id: '1405'
  _wp_old_slug: '1405'
author:
  login: bojanskr
  email: bojanskr@gmail.com
  display_name: TehBoyan
  first_name: Bojan
  last_name: Skrchevski
permalink: "/2015/03/13/sql-server-delete-duplicate-rows-with-cte/"
---
<p><!-- wp:paragraph --></p>
<p>Here's a code snippet to remove duplicate rows in a table:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:syntaxhighlighter/code --></p>
<pre class="wp-block-syntaxhighlighter-code"> WITH CTE (Column1, Column2, DuplicateCount)  
 AS  
 (  
 SELECT Column1,Column2,  
 ROW_NUMBER() OVER(PARTITION BY Column1,Column2 ORDER BY Column1) AS DuplicateCount  
 FROM TheTable  
 )  
 DELETE  
 FROM CTE  
 WHERE DuplicateCount &gt; 1  
 GO  
</pre>
<p><!-- /wp:syntaxhighlighter/code --></p>
<p><!-- wp:paragraph --></p>
<p>More on Common Table Expressions(CTE) can be found here:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>http://msdn.microsoft.com/en-us/library/ms190766(v=sql.105).aspx</p>
<p><!-- /wp:paragraph --></p>
